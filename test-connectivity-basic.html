<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste B√°sico de Conectividade</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 20px; }
        .error { background: #fee2e2; color: #dc2626; padding: 15px; border-radius: 6px; margin: 10px 0; }
        .success { background: #dcfce7; color: #166534; padding: 15px; border-radius: 6px; margin: 10px 0; }
        .info { background: #dbeafe; color: #1e40af; padding: 15px; border-radius: 6px; margin: 10px 0; }
        button { background: #2563eb; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; margin: 5px; }
        pre { background: #f9fafb; padding: 15px; border-radius: 6px; overflow-x: auto; white-space: pre-wrap; }
        input { padding: 8px; margin: 5px; border: 1px solid #ccc; border-radius: 4px; width: 400px; }
        label { display: block; margin-top: 10px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>üîç Teste B√°sico de Conectividade</h1>
    
    <div class="container">
        <h3>üåê Testes de Rede B√°sicos</h3>
        <button onclick="testBasicConnectivity()">Testar Conectividade B√°sica</button>
        <button onclick="testPublicAPIs()">Testar APIs P√∫blicas</button>
        <button onclick="testSupabaseStatus()">Verificar Status Supabase</button>
        <div id="result"></div>
    </div>

    <div class="container">
        <h3>üîß Teste com Suas Credenciais</h3>
        <label>URL do Supabase:</label>
        <input type="text" id="customUrl" value="https://qmlekowxbfbxfskywmx.supabase.co" />
        
        <label>Chave Anon:</label>
        <input type="text" id="customKey" value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFtbGVrb3d4YmZieGZza3l3bXgiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTcyOTU0NjQwMCwiZXhwIjoyMDQ1MTIyNDAwfQ.wEJY_wuHjQmMWCqWJhBdZOLdP0kKHBxkLOLcQfKEhQo" />
        
        <br><br>
        <button onclick="testCustomCredentials()">Testar Minhas Credenciais</button>
        <div id="customResult"></div>
    </div>

    <script>
        function showResult(html, elementId = 'result') {
            document.getElementById(elementId).innerHTML = html;
        }

        async function testBasicConnectivity() {
            showResult('<div class="info">üîç Testando conectividade b√°sica...</div>');
            
            let html = '<div class="info">üìã Testes de Conectividade:</div>';

            // Teste 1: Google (sempre funciona)
            try {
                const response = await fetch('https://www.google.com', { 
                    method: 'HEAD', 
                    mode: 'no-cors',
                    cache: 'no-cache'
                });
                html += `<div class="success">‚úÖ Google: Conectividade OK</div>`;
            } catch (err) {
                html += `<div class="error">‚ùå Google: ${err.message}</div>`;
            }

            // Teste 2: GitHub API (teste CORS)
            try {
                const response = await fetch('https://api.github.com/zen');
                const text = await response.text();
                html += `<div class="success">‚úÖ GitHub API: ${text.substring(0, 50)}...</div>`;
            } catch (err) {
                html += `<div class="error">‚ùå GitHub API: ${err.message}</div>`;
            }

            // Teste 3: JSONPlaceholder (teste API REST)
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/posts/1');
                const data = await response.json();
                html += `<div class="success">‚úÖ JSONPlaceholder: Post ${data.id} - ${data.title.substring(0, 30)}...</div>`;
            } catch (err) {
                html += `<div class="error">‚ùå JSONPlaceholder: ${err.message}</div>`;
            }

            showResult(html);
        }

        async function testPublicAPIs() {
            showResult('<div class="info">üîç Testando APIs p√∫blicas...</div>');
            
            let html = '<div class="info">üìã Testes de APIs P√∫blicas:</div>';

            const apis = [
                { name: 'HTTPBin', url: 'https://httpbin.org/get' },
                { name: 'ReqRes', url: 'https://reqres.in/api/users/1' },
                { name: 'Cat Facts', url: 'https://catfact.ninja/fact' }
            ];

            for (const api of apis) {
                try {
                    const response = await fetch(api.url);
                    if (response.ok) {
                        const data = await response.json();
                        html += `<div class="success">‚úÖ ${api.name}: Funcionando</div>`;
                    } else {
                        html += `<div class="error">‚ùå ${api.name}: HTTP ${response.status}</div>`;
                    }
                } catch (err) {
                    html += `<div class="error">‚ùå ${api.name}: ${err.message}</div>`;
                }
            }

            showResult(html);
        }

        async function testSupabaseStatus() {
            showResult('<div class="info">üîç Verificando status do Supabase...</div>');
            
            let html = '<div class="info">üìã Status do Supabase:</div>';

            // Teste 1: Status page do Supabase
            try {
                const response = await fetch('https://status.supabase.com/api/v2/status.json');
                const data = await response.json();
                html += `
                    <div class="success">‚úÖ Supabase Status Page: ${data.status.description}</div>
                    <div>√öltima atualiza√ß√£o: ${new Date(data.page.updated_at).toLocaleString()}</div>
                `;
            } catch (err) {
                html += `<div class="error">‚ùå Supabase Status: ${err.message}</div>`;
            }

            // Teste 2: Ping gen√©rico do Supabase
            try {
                const response = await fetch('https://supabase.com', { 
                    method: 'HEAD', 
                    mode: 'no-cors' 
                });
                html += `<div class="success">‚úÖ Supabase.com: Acess√≠vel</div>`;
            } catch (err) {
                html += `<div class="error">‚ùå Supabase.com: ${err.message}</div>`;
            }

            showResult(html);
        }

        async function testCustomCredentials() {
            const url = document.getElementById('customUrl').value;
            const key = document.getElementById('customKey').value;

            showResult('<div class="info">üîç Testando suas credenciais...</div>', 'customResult');
            
            let html = '<div class="info">üìã Teste das Suas Credenciais:</div>';

            if (!url || !key) {
                html += `<div class="error">‚ùå Por favor, preencha URL e chave</div>`;
                showResult(html, 'customResult');
                return;
            }

            // Teste 1: Ping b√°sico
            try {
                const response = await fetch(`${url}/rest/v1/`, {
                    method: 'HEAD',
                    headers: { 'apikey': key }
                });
                html += `<div class="${response.ok ? 'success' : 'error'}">
                    ${response.ok ? '‚úÖ' : '‚ùå'} Ping: ${response.status} ${response.statusText}
                </div>`;
            } catch (err) {
                html += `<div class="error">‚ùå Ping: ${err.message}</div>`;
            }

            // Teste 2: Health check
            try {
                const response = await fetch(`${url}/rest/v1/health`, {
                    headers: { 'apikey': key }
                });
                if (response.ok) {
                    html += `<div class="success">‚úÖ Health Check: OK</div>`;
                } else {
                    html += `<div class="error">‚ùå Health Check: ${response.status}</div>`;
                }
            } catch (err) {
                html += `<div class="error">‚ùå Health Check: ${err.message}</div>`;
            }

            // Teste 3: Auth health
            try {
                const response = await fetch(`${url}/auth/v1/health`, {
                    headers: { 'apikey': key }
                });
                if (response.ok) {
                    html += `<div class="success">‚úÖ Auth Health: OK</div>`;
                } else {
                    html += `<div class="error">‚ùå Auth Health: ${response.status}</div>`;
                }
            } catch (err) {
                html += `<div class="error">‚ùå Auth Health: ${err.message}</div>`;
            }

            showResult(html, 'customResult');
        }

        // Auto-executar teste b√°sico
        window.onload = function() {
            testBasicConnectivity();
        };
    </script>
</body>
</html>

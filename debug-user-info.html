<!DOCTYPE html>
<html>
<head>
    <title>Debug - Informa√ß√µes do Usu√°rio Samuel</title>
    <style>
        body { font-family: monospace; padding: 20px; background: #f5f5f5; }
        .info-box { background: white; padding: 15px; margin: 10px 0; border-radius: 8px; border-left: 4px solid #007bff; }
        .error { border-left-color: #dc3545; }
        .success { border-left-color: #28a745; }
        .warning { border-left-color: #ffc107; }
        pre { background: #f8f9fa; padding: 10px; border-radius: 4px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç Debug - Samuel Bueno User Info</h1>
    
    <div class="info-box">
        <h3>üìã Instru√ß√µes</h3>
        <p>1. Fa√ßa login como Samuel Bueno em: <strong>https://app.grupoggv.com</strong></p>
        <p>2. Abra o Console do navegador (F12)</p>
        <p>3. Cole e execute o c√≥digo JavaScript abaixo:</p>
    </div>

    <div class="info-box">
        <h3>üîß C√≥digo para Debug</h3>
        <pre>
// Debug do usu√°rio atual
console.log('=== DEBUG SAMUEL BUENO ===');

// 1. Verificar localStorage
const savedUser = localStorage.getItem('ggv-user');
if (savedUser) {
    const user = JSON.parse(savedUser);
    console.log('üë§ Usu√°rio no localStorage:', user);
    console.log('üìß Email:', user.email);
    console.log('üé≠ Role:', user.role);
    console.log('‚ö° Function:', user.user_function);
} else {
    console.log('‚ùå Nenhum usu√°rio no localStorage');
}

// 2. Verificar sessionStorage
const sessionUser = sessionStorage.getItem('ggv-user');
if (sessionUser) {
    const user = JSON.parse(sessionUser);
    console.log('üíæ Usu√°rio no sessionStorage:', user);
} else {
    console.log('‚ùå Nenhum usu√°rio no sessionStorage');
}

// 3. Verificar contexto React (se dispon√≠vel)
if (window.React && window.React.version) {
    console.log('‚öõÔ∏è React detectado, vers√£o:', window.React.version);
}

// 4. For√ßar atualiza√ß√£o do perfil via Supabase (se dispon√≠vel)
if (window.supabase) {
    console.log('üóÑÔ∏è Supabase detectado, consultando perfil...');
    
    window.supabase.auth.getUser().then(({ data: { user } }) => {
        if (user) {
            console.log('üë§ Usu√°rio Supabase:', user.email);
            
            // Consultar perfil na tabela profiles
            window.supabase
                .from('profiles')
                .select('role, user_function, name, email')
                .eq('id', user.id)
                .single()
                .then(({ data: profile, error }) => {
                    if (error) {
                        console.error('‚ùå Erro ao consultar profile:', error);
                    } else {
                        console.log('üìä Profile do banco:', profile);
                        console.log('üé≠ Role no banco:', profile.role);
                        console.log('‚ö° Function no banco:', profile.user_function);
                        
                        // Verificar se est√° correto
                        if (profile.role === 'ADMIN' && profile.user_function === 'Gestor') {
                            console.log('‚úÖ CONFIGURA√á√ÉO CORRETA - Samuel deveria ter acesso completo');
                        } else {
                            console.log('‚ùå CONFIGURA√á√ÉO INCORRETA:');
                            console.log('   Role esperado: ADMIN, atual:', profile.role);
                            console.log('   Function esperada: Gestor, atual:', profile.user_function);
                        }
                    }
                });
        } else {
            console.log('‚ùå Usu√°rio n√£o logado no Supabase');
        }
    });
} else {
    console.log('‚ùå Supabase n√£o detectado na janela');
}

console.log('=== FIM DEBUG ===');
        </pre>
    </div>

    <div class="info-box warning">
        <h3>‚ö†Ô∏è Resultados Esperados</h3>
        <p><strong>Se estiver funcionando corretamente:</strong></p>
        <ul>
            <li>Role: "ADMIN"</li>
            <li>Function: "Gestor"</li>
            <li>Mensagem: "CONFIGURA√á√ÉO CORRETA"</li>
        </ul>
    </div>

    <div class="info-box error">
        <h3>‚ùå Se n√£o estiver funcionando</h3>
        <p><strong>Poss√≠veis problemas:</strong></p>
        <ul>
            <li>Role diferente de "ADMIN"</li>
            <li>Function null, undefined ou "SDR"</li>
            <li>Usu√°rio n√£o encontrado no banco</li>
        </ul>
        <p><strong>Solu√ß√£o:</strong> Execute o script SQL <code>corrigir-samuel-definitivo.sql</code></p>
    </div>

    <div class="info-box success">
        <h3>‚úÖ Ap√≥s Corre√ß√£o</h3>
        <p>Samuel deveria ver no menu:</p>
        <ul>
            <li>‚úÖ Feedback de Oportunidade</li>
            <li>‚úÖ Reativa√ß√£o de Leads (N8N)</li>
            <li>‚úÖ Configura√ß√µes</li>
        </ul>
        <p>E ter <strong>vis√£o de Gestor</strong> ao inv√©s de SDR</p>
    </div>
</body>
</html>

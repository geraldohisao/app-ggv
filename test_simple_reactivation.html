<!DOCTYPE html>
<html>
<head>
    <title>Teste Simples - Reativa√ß√£o</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>üîç Teste Simples - Hist√≥rico Reativa√ß√£o</h1>
    <button onclick="testDirect()">1. Teste Direto</button>
    <button onclick="testRPC()">2. Teste RPC</button>
    <button onclick="testAuth()">3. Verificar Auth</button>
    <div id="output"></div>

    <script>
        const supabase = window.supabase.createClient(
            'https://pqmjfwmbitodwtpedlle.supabase.co',
            'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InBxbWpmd21iaXRvZHd0cGVkbGxlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MjM2NTAzOTIsImV4cCI6MjAzOTIyNjM5Mn0.Ov_15HvlNEv7wEjYhMgCjjsKTgzE7xNZKgOtAULKIHE'
        );

        function log(message) {
            document.getElementById('output').innerHTML += '<p>' + message + '</p>';
            console.log(message);
        }

        async function testDirect() {
            log('üîç Testando acesso direto...');
            try {
                const { data, error, count } = await supabase
                    .from('reactivated_leads')
                    .select('*', { count: 'exact' });
                
                log(`‚úÖ Direto: ${count} registros, erro: ${error?.message || 'nenhum'}`);
                if (data) log(`üìä Primeiros dados: ${JSON.stringify(data.slice(0, 2), null, 2)}`);
            } catch (e) {
                log(`‚ùå Erro direto: ${e.message}`);
            }
        }

        async function testRPC() {
            log('üîç Testando RPC...');
            try {
                const { data, error } = await supabase.rpc('get_reactivated_leads_history', {
                    p_page: 1,
                    p_limit: 5,
                    p_sdr: null,
                    p_status: null
                });
                
                log(`‚úÖ RPC: ${data?.length || 0} registros, erro: ${error?.message || 'nenhum'}`);
                if (data) log(`üìä Dados RPC: ${JSON.stringify(data, null, 2)}`);
            } catch (e) {
                log(`‚ùå Erro RPC: ${e.message}`);
            }
        }

        async function testAuth() {
            log('üîç Verificando autentica√ß√£o...');
            try {
                const { data: { user }, error } = await supabase.auth.getUser();
                log(`üë§ Usu√°rio: ${user?.email || 'n√£o logado'}, erro: ${error?.message || 'nenhum'}`);
            } catch (e) {
                log(`‚ùå Erro auth: ${e.message}`);
            }
        }
    </script>
</body>
</html>
